extends layout
block content


  -var nextPage = parseInt(page,10)+1 
  -var prevPage = page==0 ? 0 : parseInt(page,10)-1 
  
  -var hidePrevButton = page==0 ? 'none' : 'flex' 
  -var hideNextButton = nRegistos > 7 ? 'flex' : 'none'

  -var campos= ["Processo","Relator","Descritores"]


  header.w3-bar.w3-blue-dark.w3-wide.w3-card
    a.w3-bar-item
      img.w3-left(src='/images/themis.ico', alt='Logo', style='max-height: 30px; margin: 10px')
      h5.w3-left(style="margin: 10px") EW - Sistema de Acordãos

    .w3-right.w3-hide-small(style='margin: 10px; margin-right: 15px')
      a.w3-bar-item.w3-button(href='/alteracoes') SUGERIR ALTERAÇÕES
      a.w3-bar-item.w3-button(href='/acordaos') HOME
      a.w3-bar-item.w3-button(href='/login') LOGIN
      a.w3-bar-item.w3-button(href="/add") ADD

  body.w3-container
    .w3-container-4.w3-right(style='width:70%') 
      .w3-container
        if nRegistos > 0
          table.w3-table-all
            tr
              th Processo
              th Data
              th Relator
              th Descritores
              th
            each processo in processos
              tr
                td #[a(href="/acordaos/"+processo._id)= processo.Processo]
                td= processo['Data do Acordão']
                td= processo.Relator
                td(style='width: 45%; word-wrap: break-word;')= processo.Descritores

                - var corAmarela = processo._id in favoritos.map(a => a._id)
                if corAmarela
                  td #[img#star(src='/images/estrela2.png', onmouseover="this.src='/images/estrela2.png'", onclick=`removerPreferido(${processo});${corAmarela=false}`)]
                else 
                  td #[img#star(src='/images/estrela.png', onmouseover="this.src='/images/estrela2.png'", onmouseout="this.src='/images/estrela.png'", onclick=`adicionarPreferido(${processo});${corAmarela=true}`)]
                script(src='../public/javascripts/script.js')
                

          .w3-container(style='max-height: 30px;').w3-center
            button#pag(onclick=`loadPagina(${prevPage},${pageDirection=false},'${JSON.stringify(queries)}')` style=`display: ${hidePrevButton}`).w3-left
              img#pag(src='/images/esquerda.ico', alt='pagEsquerda')

            input#pag.w3-center(value='Página '+page readonly)
            
            button#pag(onclick=`loadPagina(${nextPage},${pageDirection=true},'${JSON.stringify(queries)}')` style=`display: ${hideNextButton}`).w3-right
              img#pag(src='/images/direita.ico', alt='pagDireita')

        else
          h5.w3-center Não foram encontrados registos!

    .w3-container-4.w3-left(style='width:10%; margin-left:15px')
        form(action='/acordaos')
  
          each campo in campos
            div#form
              input#campo(type='text', name=campo, placeholder=campo, value=queries.campo)
              button#erase(onclick=`document.getElementById(${campo}).value = ''`) 
                img#erase(src='/images/erase.ico', alt='Limpar')
          
          div#form
            select#tribunal(style="max-width:156%")
              option(value='')= "- Todos os tribunais -" + "   "
              each v, key in tribunais
                option(value=v) #{key}
                
            button#erase(onclick="document.getElementById('tribunal').value = ''")
              img#erase(src='/images/erase.ico', alt='Limpar')
          
          div#form
            input#Submit(type='submit', value='Pesquisar' style="min-width:176%")  
    
        script.
          document.querySelector('form').addEventListener('submit', function(event) {
            const selectElement = document.getElementById('tribunal');
            selectElement.setAttribute('name', 'tribunal');
          });

  footer.w3-container.w3-blue-dark
    h5 &COPY Generated by João Braga, Rafael Ferreira, Marta Sá :: EngWeb2023
